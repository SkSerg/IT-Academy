### Исследовательский проект по применению компьютерного зрения в производстве медицинского оборудования из силикона

ссылка на презентацию: https://docs.google.com/presentation/d/1LVpt0HAeDjyxZofSWHgqIYejr4dFgSGRvZ8XeizMTLw/edit?usp=sharing

## Цель проекта:
1. Отработотка полного пайплайна, включая сбор и подготовку данных, подбор модели, тренировка модели, оценку качества, написание приложения, развёртывание приложения на Raspberry Pi 4.

2.Провека эфективности и возможности компьютерного зрения в производстве изделий для медицины из силикона


## Этапы проекта

# Изготовление макетного образца демонстратора идеи

Стенд был собран на базе Raspberry Pi 4, камеры Raspberry Pi High Quality, дисплея Raspberry Pi Touch Display, круговая подсветка

# Сбор данных, подбор и обучение моделей

Было собрано 12194 фотографии для тренировочного сета и 1530 фотографий для теста. Количество равномерно распределено по трём классам
Исследовались следующие модели из библиотеки tensorflow: MobileNet, МоbileNetV2, EfficientNetV2B3

# Реализация на стенде

Разработано приложение на базе библиотеки PySide6


### Реализация исследований

Для исследования был взят медицинский дренаж из силикона имеющий три варианта внутренней конфигурации. 
Задача с макимальной точность определять положение дренажа относительно отметок на основании. 
Для этого были выбраны три класса: 
0 - дренаж находится по середине относительно меток, 
1- средняя часть дренажа  находится слева от меток, 
2- средняя часть дренажа  находится справа от меток

В ходе исследовательских работ подбирались варианты освещения изделия, местоположения на подложке. Каждый раз собирался датасет в количестве 3 тыс фотографий для тренировки и 1500 для теста. В результате было собрано 4 комплекта.

Тренировка моделей показывала точность не более 76%.

Далее было принято решение объединить все тренировочные датасеты в один, что увеличило количество фотографий для тренировки до 12194. Тренировка на этом датасете позволила поднять точность до 82%

Далее было проведено исследование моделей и методов их тренировок

В начале была взята каждая из (MobileNet, МоbileNetV2, EfficientNetV2B3) моделей заморожена основная часть добавлена классификационная часть, разморожени последнии 8-12 слоёв, в зависимости от моделей.
Даже при использовании большого датасета не удалось превысить 82% точности.
К слову сказать EfficientNetV2B3 обучаться отказывался. Максимум 35% точности

Учитывая то, что у меня уже был достаточно большой датасет 12 тыс, я решил обучить всю модель на своих данных. И уже на 50-60 эпохах я получил точность 98% на тестовых данных. Причём обучилась и EfficientNetV2B3

              precision    recall  f1-score   support

           0       0.99      0.98      0.98       477
           1       0.97      0.99      0.98       540
           2       0.99      0.98      0.98       513

    accuracy                           0.98      1530
   macro avg       0.98      0.98      0.98      1530
weighted avg       0.98      0.98      0.98      1530


array([[469,   6,   2],
       [  5, 532,   3],
       [  2,  10, 501]], dtype=int64)


Далее были проведены исследования на стенде.  Модель уверенно определяло положение 0 и 1, при определении положения 2 иногда проскакивал класс 1 1. Эту проблему можно попыталься решить или наложением фильтра
2. Можно игнорировать положение 1 если после положения 0 появилось положение 2 и наоборот
3. Поработать над датасетом

### Выводы

Исследования показали перспективность применения компьютерного зрения для классификации не явно заметных внутренних структур медицинских силиконовых изделий
